New typed core logic for MWAP v2 APIs